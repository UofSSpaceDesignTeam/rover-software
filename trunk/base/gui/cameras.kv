#:import Clock kivy.clock

<TurretScreen@FloatLayout>:
	Image:
		pos: (0, 0)
		id: loadImg
		size: root.size
		allow_stretch: True
		keep_ratio: False
		source: "gui/resource/loading.jpg"
	FloatLayout:
		id: controls
		Button:
			pos: (root.size[0] / 2 - 35, root.size[1] - 30)
			size_hint: (None, None)
			size: (70, 25)
			text: "Capture"
			on_release: app.commThread.mailbox.put({"takePicture":""})

<DriveScreen@FloatLayout>:
	Image:
		pos: (0, 0)
		id: loadImg
		size: root.size
		allow_stretch: True
		keep_ratio: False
		source: "gui/resource/loading.jpg"
	BoxLayout:
		id: controls
		size_hint: (None, None)
		size: (240, 40)
		pos: (root.width/2 - 120, root.height - 40)
		BoxLayout:
			orientation: "vertical"
			Label:
				color: [0, 1, 0, 1]
				text: "Throttle: " + str(int(throttle.value)) + "%"
			Slider:
				id: throttle
				padding: 20
				value: 30
				step: 10
				on_value: app.inputThread.mailbox.put({"driveThrottle":self.value_normalized})
		ToggleButton:
			size_hint: (None, None)
			size: (80, 25)
			text: "SCIENCE"
			on_state: app.commThread.mailbox.put({"drill":0})
			on_release: app.drillMode()
				
<ExperimentControls>:
	FloatLayout:
		BoxLayout:
			orientation: "vertical"
			pos: (root.size[0] / 2 - 150, 5)
			size_hint: (None, None)
			size: (330, 70)
			Label:
				id: laserData
				color: [0, 1, 0, 1]
				text: "Photo data: NONE"
			BoxLayout:
				ToggleButton:
					text: "Log Data"
					on_state: app.teleThread.log = (self.state == "down")
				Button:
					text: "Fire Laser 1"
					on_press: app.commThread.mailbox.put({"laser":1})
					on_release:	app.commThread.mailbox.put({"laser":0})
				Button:
					text: "Fire Laser 2"
					group: "laser"
					on_press: app.commThread.mailbox.put({"laser":2})
					on_release:	app.commThread.mailbox.put({"laser":0})
				Button:
					text: "Fire Laser 3"
					group: "laser"
					on_press: app.commThread.mailbox.put({"laser":3})
					on_release:	app.commThread.mailbox.put({"laser":0})
				
		BoxLayout:
			pos: (root.size[0] / 2 - 400, 5)
			size_hint: (None, None)
			size: (200, 60)
			orientation: 'vertical'
			BoxLayout:
				ToggleButton:
					text: "Drill In"
					group: "drill"
					on_state: app.commThread.mailbox.put({"drill":0 if self.state == "normal" else 1})
				ToggleButton:
					text: "Drill Out"
					group: "drill"
					on_state: app.commThread.mailbox.put({"drill":0 if self.state == "normal" else -1})
			Slider:
				id: drillSpeed
				padding: 30
				value: 30
				step: 10
				on_value: app.commThread.mailbox.put({"drillspd":self.value_normalized})
		BoxLayout:
			pos: (root.size[0] / 2 + 200, 5)
			size_hint: (None, None)
			size: (200, 60)
			orientation: 'vertical'
			BoxLayout:
				Button:
					group: "elev"
					text: "Move Up"
					on_press: app.commThread.mailbox.put({"elev":1})
					on_release: app.commThread.mailbox.put({"elev":0})
				Button:
					group: "elev"
					text: "Move Down"
					on_press: app.commThread.mailbox.put({"elev":-1})
					on_release: app.commThread.mailbox.put({"elev":0})
			Slider:
				id: elevSpeed
				padding: 30
				value: 30
				step: 10
				on_value: app.commThread.mailbox.put({"elevspd":self.value_normalized})
		
<ArmScreen@FloatLayout>:
	
	Image:
		pos: (0, 0)
		id: loadImg
		size: root.size
		allow_stretch: True
		keep_ratio: False
		source: "gui/resource/loading.jpg"
	ArmSliders:
	BoxLayout:
		id: controls
		size_hint: (None, None)
		size: (root.width / 2, 25)
		pos: (root.width / 4, root.height - 30)
		Label:
			color: [0, 1, 0, 1]
			text: "Power: " + str(int(throttle.value)) + "%"
		Slider:
			id: throttle
			padding: 20
			value: 50
			step: 10
			on_value: app.commThread.mailbox.put({"armThrottle":self.value_normalized})
		ToggleButton:
			id: invKin
			group: "mode"
			text: "Inverse Kin"
			on_state: app.inputThread.mailbox.put({"armMode":(self.state!="normal", armCont.state!="normal")})
		ToggleButton:
			id: armCont
			group: "mode"
			text: "Controller"
			on_state: app.inputThread.mailbox.put({"armMode":(invKin.state!="normal", self.state!="normal")})

<ArmSliders@Scatter>
	size_hint: (None, None)
	size: (475, 550)
	FloatLayout:
		size_hint: (None, None)
		size: (475, 550)
		pos: (0,0)
		canvas:
			Color:
				rgba: 0, 0, 0, 0.5
			Rectangle:
				pos: (0, 0)
				size: (475, 550)
		Image:
			size_hint: (None, None)
			pos: (60, 80)
			size: (400, 400)
			source: "gui/resource/armHelper.png"
			allow_stretch: False
		BoxLayout:
			size_hint: (None, None)
			size: (20, 500)
			pos: (25,25)
			orientation: "vertical"
			Slider:
				orientation: "vertical"
				id: armZ
				size_hint: (1, .95)
				padding: 10
				range: (-800, 800)
				value: 200
				step: .1
				on_value: app.inputThread.mailbox.put({"armZ":self.value})
			Label:
				size_hint: (1, .05)
				text: "Z: " + str(int(armZ.value))
		BoxLayout:
			size_hint: (None, None)
			size: (400, 20)
			pos: (45,500)
			Slider:
				id: armRad
				size_hint: (.95, 1)
				padding: 30
				range: (-800, 800)
				value: 200
				step: .1
				on_value: app.inputThread.mailbox.put({"armRad":self.value})
			Label:
				size_hint: (.05, 1)
				text: "Rad: " + str(int(armRad.value))
		BoxLayout:
			size_hint: (None, None)
			size: (400, 20)
			pos: (45,45)		
			Slider:
				id: armBase
				size_hint: (.95, 1)
				padding: 30
				range: (-100, 100)
				value: 0
				step: .1
				on_value: app.inputThread.mailbox.put({"armBase":self.value})
				on_touch_up: app.centerSliderHelper(self)
			Label:
				size_hint: (.05, 1)
				text: "Base: " + str(int(armBase.value))
		BoxLayout:
			size_hint: (None, None)
			size: (200, 20)
			pos: (200, 350)	
			Slider:
				id: armPhi
				size_hint: (.95, 1)
				padding: 30
				range: (-45, 45)
				value: 0
				step: .1
				on_value: app.inputThread.mailbox.put({"armPhi":self.value})
			Label:
				size_hint: (.05, 1)
				text: "Ang: " + str(int(armPhi.value))
		BoxLayout:
			size_hint: (None, None)
			size: (150, 100)
			pos: (225, 200)
			orientation: "vertical"
			BoxLayout:
				Button:
					text: "open"
				Button:
					text: "close"
			BoxLayout:
				Button:
					text: "left"
				Button:
					text: "right"

