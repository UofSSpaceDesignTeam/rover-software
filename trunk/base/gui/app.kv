# widget tree root that actually gets built at runtime
# definitions follow

AppRoot:
# App root widget
<AppRoot@BoxLayout>:
	orientation: "vertical"
	TabBar:
		size_hint: (None, None)
		size: (1024, 50)
	ScreenManager:
		id: sm
		SplashScreen:
			name: "splash"
		TelemetryScreen:
			name: "telemetry"
		NavigationScreen:
			name: "navigation"
		TurretScreen:
			name: "turret"
		DriveScreen:
			name: "drive" 
		ArmScreen:
			name: "arm"
		ImageScreen:
			name: "image"
		SettingsScreen:
			name: "settings"

# tab switcher bar
<TabBar@BoxLayout>:
	ActionBar:
		ActionView:
			use_separator: True
			ActionPrevious:
				size_hint: (None, None)
				size: (65, 50)
				app_icon: "gui/resource/icon.png"
				title: ""
				with_previous: False
				on_release: app.changeScreen("splash")
			ActionGroup:
				ActionButton:
					text: "Settings"
					on_release: app.changeScreen("settings")
			ActionGroup:
				ActionButton:
					text: "Telemetry"
					on_release: app.changeScreen("telemetry")
			ActionGroup:
				ActionButton:
					text: "Navigation"
					on_release: app.changeScreen("navigation")
			ActionGroup:
				ActionButton:
					text: "Turret Camera"
					on_release: app.changeScreen("turret")
			ActionGroup:
				ActionButton:
					text: "Image Analysis"
					on_release: app.changeScreen("image")
			ActionGroup:
				ActionButton:
					text: "Arm Camera"
					on_release: app.changeScreen("arm")
			ActionGroup:
				ActionButton:
					text: "Drive Camera"
					on_release: app.changeScreen("drive")
			ActionGroup:
				ActionButton:
					width: 0

# startup splash screen tab
<SplashScreen@BoxLayout>:
	Image:
		size: (root.size[0], root.size[1])
		allow_stretch: True
		keep_ratio: True
		source: "gui/resource/splash.jpg"

# turret-mounted camera view tab (video player built in python)
<TurretScreen@FloatLayout>:
	# static background image
	Image:
		pos: (0, 0)
		id: loadImg
		size: root.size
		allow_stretch: True
		keep_ratio: False
		source: "gui/resource/loading.jpg"
	
	FloatLayout:
		id: controls
		# picture-taking button
		Button:
			pos: (root.size[0] / 2 - 35, root.size[1] - 40)
			size_hint: (None, None)
			size: (70, 25)
			text: "Capture"
			on_release: app.takePicture("turret")

# front-mounted camera view tab (video player built in python)
<DriveScreen@FloatLayout>:
	# static background image
	Image:
		pos: (0, 0)
		id: loadImg
		size: root.size
		allow_stretch: True
		keep_ratio: False
		source: "gui/resource/loading.jpg"
	
	FloatLayout:
		id: controls
		# picture-taking button
		Button:
			pos: (root.size[0] / 2 - 35, root.size[1] - 40)
			size_hint: (None, None)
			size: (70, 25)
			text: "Capture"
			on_release: app.takePicture("drive")

# arm-mounted camera view tab (video player built in python)
<ArmScreen@FloatLayout>:
	# static background image
	Image:
		pos: (0, 0)
		id: loadImg
		size: root.size
		allow_stretch: True
		keep_ratio: False
		source: "gui/resource/loading.jpg"
	
	FloatLayout:
		id: controls
		# picture-taking button
		Button:
			pos: (root.size[0] / 2 - 35, root.size[1] - 40)
			size_hint: (None, None)
			size: (70, 25)
			text: "Capture"
			on_release: app.takePicture("arm")

# image analysis tab
<ImageScreen@BoxLayout>:

